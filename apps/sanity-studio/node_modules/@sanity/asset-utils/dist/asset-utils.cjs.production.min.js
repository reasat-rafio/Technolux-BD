"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function i(t,e,o){return(i=n()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function o(t){var n="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,o)}function o(){return i(t,arguments,e(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),r(o,t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0});var s=Object.freeze({left:0,top:0,bottom:0,right:0}),a=Object.freeze({x:.5,y:.5,height:1,width:1}),u=function(){return t({},s)},f=function(){return t({},a)},p=function(t){var e,r;function n(e,r){var n;return void 0===r&&(r="Failed to resolve asset ID from source"),(n=t.call(this,r)||this).unresolvable=!0,n.input=e,n}return r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,n}(o(Error));function l(t){return Boolean(t.unresolvable&&"input"in t)}function c(t){return function(){try{return t.apply(void 0,arguments)}catch(t){if(l(t))return;throw t}}}var d="https://cdn.sanity.io",h=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})+\.[a-z0-9]+$/,x=/^file-[a-zA-Z0-9_]+-[a-z0-9]+$/,g=/^([a-zA-Z0-9_]{24,40}|[a-f0-9]{40})-\d+x\d+\.[a-z0-9]+$/,m=/^image-[a-zA-Z0-9_]+-\d+x\d+-[a-z0-9]+$/,v=/^(images|files)\/([a-z0-9]+)\/([a-z0-9][-\w]*)\//,y=/^(?:image-[a-zA-Z0-9_]+-\d+x\d+-[a-z0-9]+|file-[a-zA-Z0-9_]+-[a-z0-9]+)$/,w={projectId:"a",dataset:"b"};function I(t){return _(t)&&"string"==typeof t._ref}function b(t){return _(t)&&"string"==typeof t._id}function A(t){return _(t)&&"string"==typeof t.path}function F(t){return _(t)&&"string"==typeof t.url}function j(t){var e=t;return _(e)&&e.asset&&"object"==typeof e.asset}function _(t){return null!==t&&!Array.isArray(t)&&"object"==typeof t}function U(t,e){var r=(null==e?void 0:e.projectId)||t.projectId,n=(null==e?void 0:e.dataset)||t.dataset;if(!r||!n)throw new Error("Project details (projectId and dataset) required to resolve path for image");var i="metadata"in t?t.metadata.dimensions:{width:t.width,height:t.height},o=t.vanityFilename||("originalFilename"in t?t.originalFilename:void 0);return"images/"+r+"/"+n+"/"+t.assetId+"-"+i.width+"x"+i.height+"."+t.extension+(o?"/"+o:"")}function O(t,e){return d+"/"+U(t,e)}function S(t,e){var r=(null==e?void 0:e.projectId)||t.projectId,n=(null==e?void 0:e.dataset)||t.dataset;if(!r||!n)throw new Error("Project details (projectId and dataset) required to resolve path for file");var i=t.vanityFilename||("originalFilename"in t?t.originalFilename:void 0);return"files/"+r+"/"+n+"/"+t.assetId+"."+t.extension+(i?"/"+i:"")}function z(t,e){return d+"/"+S(t,e)}function E(t){return j(t)?E(t.asset):I(t)?void 0:"string"==typeof t?v.test(R(t)||"")?P(t):void 0:A(t)?t.path:F(t)?P(t.url):void 0}function P(t){if(v.test(t))return t;if(!t.startsWith(d+"/"))throw new p('Failed to resolve path from URL "'+t+'"');var e=t.indexOf("?");return t.slice(d.length+1,-1===e?void 0:e)}var R=c(P);function D(t){var e=(R(t)||t).replace(/^(images|files)\/[a-z0-9]+\/[a-z0-9][-\w]\/*/,"");if(!L(e))throw new p('Failed to resolve filename from URL "'+t+'"');return e}var G=c(D);function L(t){return h.test(t)||g.test(t)}function $(t){if(m.test(t))return Z(t);if(x.test(t))return T(t);throw new Error("Invalid image/file asset ID: "+t)}function T(t){if(!x.test(t))throw new Error("Malformed file asset ID '"+t+'\'. Expected an id like "file-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-pdf"');var e=t.split("-");return{type:"file",assetId:e[1],extension:e[2]}}function Z(t){var e=t.split("-"),r=e[1],n=e[2],i=e[3],o=(n||"").split("x").map(Number),s=o[0],a=o[1];if(!(r&&n&&i&&s>0&&a>0))throw new Error("Malformed asset ID '"+t+'\'. Expected an id like "image-027401f31c3ac1e6d78c5d539ccd1beff72b9b11-2000x3000-jpg".');return{type:"image",assetId:r,width:s,height:a,extension:i}}function M(t){var e=G(t)||"";if(!L(e))throw new Error("Invalid image/file asset filename: "+t);try{return $((g.test(e)?"image":"file")+"-"+e.replace(/\.([a-z0-9+]+)$/i,"-$1"))}catch(e){throw new Error("Invalid image/file asset filename: "+t)}}function W(e){if(!e.startsWith(d))throw new Error("URL is not a valid Sanity asset URL: "+e);var r=e.slice(d.length).replace(/^\/+/,""),n=r.match(v)||[],i=n[0],o=n[2],s=n[3];if(!o||!s)throw new Error("URL is not a valid Sanity asset URL: "+e);var a=r.slice(i.length).split("/"),u=a[1];return t({},M(a[0]),{projectId:o,dataset:s,vanityFilename:u})}function C(t){try{return W(t).type}catch(t){return!1}}function H(t){var e=Z(et(t)),r=e.width,n=e.height;return{width:r,height:n,aspectRatio:r/n}}var k=c(H);function q(t){return pt(t)?Q(t,w).asset.extension:N(t,w).asset.extension}var B=c(q);function N(t,e){var r=t;return{asset:J(t,e||at(t)),crop:r.crop||u(),hotspot:r.hotspot||f()}}var V=c(N);function J(e,r){var n=r||st(e),i=et(e),o=(e.asset||e).metadata||{},s=Z(i),a=s.width,u=s.height,f={_id:i,_type:"sanity.imageAsset",assetId:s.assetId,extension:s.extension,metadata:t({},o,{dimensions:{width:a,height:u,aspectRatio:a/u}}),url:"",path:""};return t({},f,{path:U(f,n),url:O(f,n)})}var K=c(J);function Q(t,e){return{asset:Y(t,e||at(t))}}var X=c(Q);function Y(e,r){var n=r||st(e),i=et(e),o=e.asset||e,s=T(i),a={_id:i,_type:"sanity.fileAsset",assetId:s.assetId,extension:s.extension,metadata:o.metadata||{},url:"",path:""};return t({},a,{path:S(a,n),url:z(a,n)})}var tt=c(Y);function et(t){var e=j(t)?t.asset:t,r="";if("string"==typeof e?r=nt(e):I(e)?r=e._ref:b(e)?r=e._id:A(e)?r=ot(d+"/"+e.path):F(e)&&(r=ot(e.url)),!r||!y.test(r))throw new p(t);return r}var rt=c(et);function nt(t){if(y.test(t))return t;if(0===t.indexOf(d+"/images")||0===t.indexOf(d+"/files"))return ot(t);if(v.test(t))return ot(d+"/"+t);if(ft(t))return ot(d+"/files/a/b/"+t);if(ut(t))return ot(d+"/images/a/b/"+t);throw new p(t)}var it=c(nt);function ot(t){var e=P(t).split("/"),r=e[3];return e[0].replace(/s$/,"")+"-"+r.replace(/\./g,"-")}function st(t){var e=E(t);if(!e)throw new p(t,"Failed to resolve project ID and dataset from source");var r=e.match(v)||[],n=r[2],i=r[3];if(!n||!i)throw new p(t,"Failed to resolve project ID and dataset from source");return{projectId:n,dataset:i}}var at=c(st);function ut(t){return g.test(t)}function ft(t){return h.test(t)}function pt(t){return et(t).startsWith("file-")}exports.DEFAULT_CROP=s,exports.DEFAULT_HOTSPOT=a,exports.buildFilePath=S,exports.buildFileUrl=z,exports.buildImagePath=U,exports.buildImageUrl=O,exports.getAssetDocumentId=et,exports.getAssetUrlType=C,exports.getDefaultCrop=u,exports.getDefaultHotspot=f,exports.getExtension=q,exports.getFile=Q,exports.getFileAsset=Y,exports.getIdFromString=nt,exports.getImage=N,exports.getImageAsset=J,exports.getImageDimensions=H,exports.getProject=st,exports.getUrlFilename=D,exports.getUrlPath=P,exports.isAssetFilename=function(t){return ut(t)||ft(t)},exports.isAssetIdStub=b,exports.isAssetObjectStub=j,exports.isAssetPathStub=A,exports.isAssetUrlStub=F,exports.isDefaultCrop=function(t){return t.top===s.top&&t.bottom===s.bottom&&t.left===s.left&&t.right===s.right},exports.isDefaultHotspot=function(t){return t.x===a.x&&t.y===a.y&&t.width===a.width&&t.height===a.height},exports.isFileAssetFilename=ft,exports.isFileSource=pt,exports.isImageAssetFilename=ut,exports.isImageSource=function(t){return et(t).startsWith("image-")},exports.isObject=_,exports.isReference=I,exports.isSanityAssetUrl=function(t){return!1!==C(t)},exports.isSanityFileAsset=function(t){return _(t)&&"sanity.fileAsset"===t._type},exports.isSanityFileUrl=function(t){return"file"===C(t)},exports.isSanityImageUrl=function(t){return"image"===C(t)},exports.isValidFilename=L,exports.parseAssetFilename=M,exports.parseAssetId=$,exports.parseAssetUrl=W,exports.parseFileAssetId=T,exports.parseFileAssetUrl=function(t){var e=W(t);if("file"!==e.type)throw new Error("URL is not a valid Sanity file asset URL: "+t);return e},exports.parseImageAssetId=Z,exports.parseImageAssetUrl=function(t){var e=W(t);if("image"!==e.type)throw new Error("URL is not a valid Sanity image asset URL: "+t);return e},exports.tryGetAssetDocumentId=rt,exports.tryGetAssetPath=E,exports.tryGetExtension=B,exports.tryGetFile=X,exports.tryGetFileAsset=tt,exports.tryGetIdFromString=it,exports.tryGetImage=V,exports.tryGetImageAsset=K,exports.tryGetImageDimensions=k,exports.tryGetProject=at,exports.tryGetUrlFilename=G,exports.tryGetUrlPath=R;
//# sourceMappingURL=asset-utils.cjs.production.min.js.map
